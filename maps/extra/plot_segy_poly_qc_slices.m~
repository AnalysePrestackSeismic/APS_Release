function plot_segy_poly_qc_slices( filepathin )

%PLOT_SEGY_POLY_QC_SLICES 

xv = [635575.77
688718.67
692404.66
657863.24
662270.00
671110.00
673570.00
671920.00
671960.00
664298.55
664326.52
662380.00
662340.00
653240.00
653230.00
649006.90
642290.93
635575.77];

yv = [8949635.57
8949430.30
8940689.92
8940662.15
8924600.00
8907900.00
8895100.00
8892800.00
8869800.00
8869800.00
8875780.41
8875788.41
8876900.00
8877100.00
8911500.00
8936290.37
8933662.39
8949635.57];

% Tanzania Block 3 Polygon
% xv = [638079.01
% 616591.06
% 606476.20
% 641453.01
% 672954.15
% 683680.74
% 668103.64
% 649928.29
% 644000.99
% 639741.26
% 636100.63
% 638079.01];
% 
% yv = [9021703.90
% 9016716.11
% 9060287.78
% 9060171.21
% 9060066.22
% 9013682.83
% 9009988.54
% 9023908.23
% 9049263.22
% 9030813.33
% 9029965.06
% 9021703.90];

% xv = [
%  962647
%  923218
%  851819
%  905189
%  962647
%  ];
% 
% yv = [
%  5929028
%  5883670
%  5945736
%  6007131
%  5929028
%  ];
% 
xv = xv.*100;
yv = yv.*100;
xv = int64(xv);
yv = int64(yv);

pltd = 200;



load(filepathin);

red = [repmat(1,50,1);(1:-0.02:0)'];
blue = [(0:0.02:1)';repmat(1,50,1)];
green = [(0:0.02:1)';(0.98:-0.02:0)'];
redblue = [red green blue];

scrsz = get(0,'ScreenSize');
cjf = figure('Position',[50 scrsz(4) scrsz(3)/1.1 (scrsz(4)/1.1)],'PaperType','A1','Visible','on','PaperPositionMode','auto','PaperOrientation','landscape');
colormap(redblue);

% colrngcj = (0.5*max(qcslice(3,1:2:endcj)));
% %props = {'LineStyle','none','Marker','o','MarkerEdge','b','MarkerSize',6};
% %line([qcslice(1,1:10:endcj),qcslice(1,1:10:endcj)],[qcslice(2,1:10:endcj),qcslice(2,1:10:endcj)],props{:});
% subplot(1,2,1)
% scatter(qcslice(4,1:pltd:endcj),qcslice(2,1:pltd:endcj),20,qcslice(3,1:pltd:endcj),'filled');
% caxis([(-1*colrngcj) colrngcj]);
% colorbar;
% hold on
% plot(xv,yv)
% hold off


%out_file_name_slice_tmp = strcat(out_file_name_slice,'_whole.pdf');

%print(cjf,'-dpdf','-noui','-r200',out_file_name_slice_tmp);


%tr_use = inpolygon(int64(qcslice(1,1:pltd:endcj)),int64(qcslice(2,1:pltd:endcj)),xv,yv);
%     %use logical to set the third dimension of the trace length to zero
%     tracesout = bsxfun(@times,traces,tr_use');

figure(1)
colrngcj = (0.5*max(qcslice(4,1:2:endcj)));
subplot(2,1,1); scatter(qcslice(1,1:pltd:endcj),qcslice(2,1:pltd:endcj),20,qcslice(4,1:pltd:endcj),'filled'); hold on; plot(xv,yv'--rs','LineWidth',2,...
                'MarkerEdgeColor','k',...
                'MarkerFaceColor','g',...
                'MarkerSize',10); 
hold off
caxis([(-1*colrngcj) colrngcj]);
colorbar;

colrngcj = (0.5*max(qcslice(6,1:2:endcj)));
subplot(2,1,2); scatter(qcslice(1,1:pltd:endcj),qcslice(2,1:pltd:endcj),20,qcslice(6,1:pltd:endcj),'filled'); hold on; plot(xv,yv'--rs','LineWidth',2,...
                'MarkerEdgeColor','k',...
                'MarkerFaceColor','g',...
                'MarkerSize',10)
); hold off
caxis([(-1*colrngcj) colrngcj]);
colorbar;

% subplot(1,2,2)
% scatter(qcslice(1,1:pltd:endcj),qcslice(2,1:pltd:endcj),20,qcslice(4,1:pltd:endcj),'filled');
% %scatter(qcslice(1,1:pltd:endcj),qcslice(2,1:pltd:endcj),20,qcslice(5,1:pltd:endcj).*tr_use,'filled');
% caxis([(-1*colrngcj) colrngcj]);
% colorbar;
% hold on
% plot(xv,yv)
% hold off
%colorbar('peer',axes1);
%out_file_name_slice_tmp = strcat(out_file_name_slice,'_sub_polygon.pdf');
%print(cjf,'-dpdf','-noui','-r200',out_file_name_slice_tmp);

%close cjf;
end

